<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Improved Side Panel Example</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
        }

        #main-content {
            transition: margin-right 0.5s;
            padding: 15px;
            width: calc(100% - 250px);
            float: left;
        }

        #side-panel {
            height: 100%;
            width: 350px;
            position: fixed;
            z-index: 1;
            top: 0;
            right: -350px;
            background-color: black;
            color: lightblue;
            overflow: auto;
            border: 7px solid rgb(191, 152, 100);
            display: none;
            /* Initially hidden */
            transition: right 0.5s ease;
            /* Add a smooth transition effect */
            animation-duration: 0.5s;
            animation-name: slideIn;
        }

        #side-panel img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url("https://ttalesinteractive.com/graphics/pencil.png");
            background-size: cover;
            background-position: center center;
            opacity: 0.1;
            z-index: -1;
        }

        #side-panel-content {
            position: absolute;
            bottom: 0;
            left: 0;
            width: calc(100% - 40px);
            padding: 20px;
        }

        #side-panel-content h2 {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            color: #45d4d1;
        }

        #side-panel-content p {
            font-size: 14px;
            color: #45d4d1;
            margin-left: 10px;
            overflow: auto;
        }

        #side-panel-content a {
            text-decoration: underline;
            margin-left: 10px;
            color: lightblue;
        }

        #open-btn {
            font-size: 20px;
            cursor: pointer;
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 2;
            max-width: 30px;
        }

        @keyframes slideIn {
            from {
                right: -350px;
            }

            to {
                right: 0;
            }
        }
    </style>
</head>

<body>

    <div id="main-content">
        <h1>Main Content</h1>
        <p>This is the main content of your site.</p>
    </div>

    <div id="side-panel">
        <img src="https://ttalesinteractive.com/graphics/pencil.png" alt="Background Image">
        <div id="side-panel-content">
            <h2 class="version">Welcome to Beta: 1.8.3</h2>
            <p class="TurtleComment">
                2/02: So Idk what to write here, I'm not as good at this as Elodine, i have been indirectly contributing
                to the
                project for a while, and now I'm officially part of it... Hi i guess.
                So changes in this version are, The prompts button as been moved with the rest of the buttons (Right
                down corner).
                The arrow to deploy the left panel now flips when it is closed (Blame my OCD).
                The buttons now have a more smooth highlight animation.
                - Turtle Guy
            </p>
            <p class="EloComment">
                1/12: New year, new problems: TTI needs your help! Enjoying the site? Consider
                <a href="https://www.buymeacoffee.com/elodine" target="_blank" class="EloCommentLink">donating to our
                    BuyMeACoffee</a>
                or
                <a href="https://www.youtube.com/@elodinecodes" target="_blank" class="EloCommentLink">tuning into a
                    livestream</a>
                to help keep this site going.
                - Elodine
            </p>

            <p class="EloComment">
                1/12: Lorebooks now work correctly. I went ahead and moved the proxy server that handles lorebooks over
                to our
                server after rewriting its code. Have fun!
                - Elodine
            </p>

            <img src="https://ttalesinteractive.com/graphics/PageBreakFix.png" alt="Page Break"
                style="display: block; margin: auto; width: 100%; margin-left: -6px;">

            <p
                style="text-align: center; font-size: 16px; color: #45d4d1; font-weight: bold; text-decoration: underline;">
                !WARNING!</p>
            <p style="font-size: 14px; color: #45d4d1;  margin-left: 10px;"> By enabling any custom prompt you are
                acknowledging you are 18 years of age or older. </p>

            <div style="font-size: 12px;" bis_skin_checked="1">
                <a style="text-decoration: underline; margin-left: 10px; color: lightblue;"
                    href="https://discord.gg/Tr8vvRUuCv" data-type="page" data-id="533">Discord &amp; Bug Reports</a>
                <a style="text-decoration: underline; margin-left: 10px; color: lightblue;"
                    href="https://ttalesinteractive.com/?page_id=1560" data-type="page">Support our Devs</a>
                <a style="text-decoration: underline; margin-left: 10px; color: lightblue;"
                    href="https://ttalesinteractive.com/?page_id=1550" data-type="page" data-id="197">Terms of
                    Service</a>
                <a style="text-decoration: underline; margin-left: 10px; color: lightblue;"
                    href="https://ttalesinteractive.com/?page_id=1552" data-type="page" data-id="193">Privacy Policy</a>
            </div>
        </div>

        <select
            title="Select an option to change the narration mode. Everything is set to a default SFW mode unless otherwise clicked."
            style="position: absolute; top: 130px; left: 10px;">
            <option value="default">Narration: SFW</option>
            <option value="GPT4">SFW GPT4-preview</option>
            <option value="NSFW">Narration: NSFW</option>
        </select>
        <button
            title="Click this button to end the narration loop. Bots may hyperfixate on narration, clicking this button will fix that in the NEXT post made by the AI. Be sure to click a SFW or NSFW option after a couple of posts to return to better quality once the loop is fixed."
            style="position: absolute; top: 70px; right: 10px;">Narration Loop Fix</button>
        <button
            title="Click this button to enable a prompt that will correct an issue where the AI and story become stale. This will force the plot to move forward by making the AI think about the narration and suspense. This will employ on the next post and help foreshadow the next plot point."
            style="position: absolute; top: 100px; right: 10px;">No Action Fix-Enable</button>
        <p style="position: absolute; top: 130px; left: 50%; transform: translateX(-50%);"></p>
        <button title="Click this button to enable TTS using your Elevenlabs API key."
            style="position: absolute; top: 70px; left: 10px;">Enable Elevenlabs</button>
        <button title="This button will toggle stats on and off."
            style="position: absolute; top: 190px; right: 10px;">Toggle Stats</button>
        <button title="Customize the text style for the AI and yourself."
            style="position: absolute; top: 190px; left: 10px;">Customize Text</button>
        <button title="This button will enable an AI to comment on your adventures."
            style="position: absolute; top: 130px; right: 10px;">Deploy Whiskers</button>
        <button style="position: absolute; top: 40px; left: 10px;">Show Game Info</button>
        <button style="position: absolute; top: 40px; right: 10px;">Show Encyclopedia</button>
        <button title="Click me to help the AI remember specific details about your current character."
            style="position: absolute; top: 100px; left: 10px;">{{user}} details</button>
        <select style="position: absolute; top: 157px; left: 75px;">
            <option value="Hastur">Hastur</option>
            <option value="Althaia">Althaia</option>
            <option value="Altyr">Altyr</option>
            <option value="Angus">Angus</option>
            <option value="Elodine">Elodine</option>
            <option value="Guthrie">Guthrie</option>
            <option value="Solveig">Solveig</option>
            <option value="Idony">Idony</option>
            <option value="Lysandra">Lysandra</option>
            <option value="Madoc">Madoc</option>
            <option value="Wulfric">Wulfric</option>
            <option value="Andrea">Andrea</option>
            <option value="Ayanda">Ayanda</option>
            <option value="Bradley">Bradley</option>
            <option value="Cyanea">Cyanea</option>
            <option value="Eadric">Eadric</option>
            <option value="Mila">Mila</option>
        </select>
        <button style="position: absolute; top: 155px; left: 10px;">Swap to:</button>
        <button title="This button will enable the AI to plan things out."
            style="position: absolute; top: 160px; right: 10px;">Enable Foresight</button>
    </div>

    <div id="open-btn" onclick="toggleSidePanel()">Open Panel</div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            var sidePanel = document.getElementById('side-panel');
            var isPanelOpen = getCookie('panelState') === 'open';

            // Check the saved version and the current version
            var savedVersion = getCookie('lastVersion');
            var currentVersionElement = document.querySelector('.version');
            var currentVersion = currentVersionElement ? currentVersionElement.innerText.trim() : '';

            if (currentVersion !== savedVersion) {
                // Update the panel state and save the new version
                sidePanel.style.display = 'block';
                sidePanel.style.right = '0px';
                setCookie('panelState', 'open');
                setCookie('lastVersion', currentVersion);
            } else if (isPanelOpen) {
                sidePanel.style.display = 'block';
                sidePanel.style.right = '0px';
            } else {
                sidePanel.style.right = '-350px';
            }
        });

        function toggleSidePanel() {
            var sidePanel = document.getElementById('side-panel');
            var mainContent = document.getElementById('main-content');
            var openBtn = document.getElementById('open-btn');

            if (sidePanel.style.right === '0px') {
                sidePanel.style.right = '-350px';
                mainContent.style.width = '100%';
                openBtn.innerHTML = 'Open Panel';
                sidePanel.classList.remove('slide-in-animation');
                sidePanel.addEventListener('transitionend', function () {
                    sidePanel.style.display = 'none';
                }, { once: true });

                // Save the panel state in a cookie
                setCookie('panelState', 'closed');
            } else {
                sidePanel.style.display = 'block';
                sidePanel.style.right = '0px';
                mainContent.style.width = 'calc(100% - 350px)';
                openBtn.innerHTML = 'Close Panel';
                sidePanel.classList.add('slide-in-animation');

                // Save the panel state and the current version in cookies
                setCookie('panelState', 'open');
                setCookie('lastVersion', document.querySelector('.version').innerText.trim());
            }
        }

        // Helper function to set a cookie
        function setCookie(name, value) {
            document.cookie = `${name}=${value}; path=/`;
        }

        // Helper function to get a cookie value
        function getCookie(name) {
            var match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));
            return match ? match[2] : null;
        }
    </script>

</body>

</html>